(out='Freed in-memory ruleset')
(out='Freed in-memory ruleset')
(1=1)
(x=1)
(x=2)
(x=3)
(comdb2_ctxinfo('priority')=xx, x=1)
(comdb2_ctxinfo('priority')=xx, x=2)
(comdb2_ctxinfo('priority')=xx, x=3)
(x=1)
(x=2)
(x=3)
(out='Ruleset loaded from file "t01.ruleset"')
(out='comdb2_dump_ruleset: ruleset 0x00000000, generation 3, rule count 6, rule fingerprint count 4')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #1 <null> seqNo 0, action {REJECT} (0x1), adjustment 0, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {a9c8b6ddb5b9e55ee41b7f5a46ec4e45}, evalCount 1, matchCount 0')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #2 <null> seqNo 0, action {LOW_PRIO} (0x8), adjustment 1000, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {f309b21fc81151d21268e9399b36994a}, evalCount 1, matchCount 0')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #3 <null> seqNo 0, action {HIGH_PRIO} (0x10), adjustment 1000, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {fb34995274c6a68a94ae4b9fcfd2d535}, evalCount 1, matchCount 0')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #4 <null> seqNo 0, action {NONE} (0x0), adjustment 0, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {4f16a8ec9db90f803e406659938b2602}, evalCount 1, matchCount 0')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #6 <null> seqNo 0, action {REJECT_ALL} (0x2), adjustment 0, flags {PRINT STOP} (0x6), mode {GLOB NOCASE} (0xA), originHost {<null>}, originTask {<null>}, user {<null>}, sql {CREATE *}, fingerprint {<null>}, evalCount 1, matchCount 0')
(2=2)
[SELECT * FROM t1] failed with rc -1 Rejected due to rule #1
(comdb2_ctxinfo('priority')=yyyy, x=1)
(comdb2_ctxinfo('priority')=yyyy, x=2)
(comdb2_ctxinfo('priority')=yyyy, x=3)
(x=1)
(x=2)
(x=3)
[CREATE TABLE txx(bad TEXT)] failed with rc 451 Rejected due to rule #6
(out='Ruleset saved to file "t01_saved.ruleset"')
(out='Ruleset saved to file "t02_saved.ruleset"')
(out='ruleset 0x00000000 matched 0, ruleNo=0, action=NONE, priority=HIGHEST')
(out='Ruleset loaded from file "t00.ruleset"')
(out='comdb2_dump_ruleset: ruleset 0x00000000, generation 4, rule count 9, rule fingerprint count 4')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #1 <null> seqNo 0, action {REJECT} (0x1), adjustment 0, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {a9c8b6ddb5b9e55ee41b7f5a46ec4e45}, evalCount 14, matchCount 3')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #2 <null> seqNo 0, action {LOW_PRIO} (0x8), adjustment 1000, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {f309b21fc81151d21268e9399b36994a}, evalCount 14, matchCount 1')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #3 <null> seqNo 0, action {HIGH_PRIO} (0x10), adjustment 1000, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {fb34995274c6a68a94ae4b9fcfd2d535}, evalCount 14, matchCount 1')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #4 <null> seqNo 0, action {NONE} (0x0), adjustment 0, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {4f16a8ec9db90f803e406659938b2602}, evalCount 14, matchCount 1')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #6 <null> seqNo 0, action {REJECT_ALL} (0x2), adjustment 0, flags {PRINT STOP} (0x6), mode {GLOB NOCASE} (0xA), originHost {<null>}, originTask {<null>}, user {<null>}, sql {CREATE *}, fingerprint {<null>}, evalCount 14, matchCount 1')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #8 <null> seqNo 0, action {NONE} (0x0), adjustment 0, flags {NONE} (0x0), mode {NONE} (0x0), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {<null>}, evalCount 1, matchCount 1')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #9 <null> seqNo 0, action {REJECT} (0x1), adjustment 0, flags {PRINT STOP} (0x6), mode {REGEXP NOCASE} (0xC), originHost {<null>}, originTask {<null>}, user {<null>}, sql {^DROP .*$}, fingerprint {<null>}, evalCount 1, matchCount 0')
(out='Freed in-memory ruleset')
(3=3)
(x=1)
(x=2)
(x=3)
(comdb2_ctxinfo('priority')=zz, x=1)
(comdb2_ctxinfo('priority')=zz, x=2)
(comdb2_ctxinfo('priority')=zz, x=3)
(x=1)
(x=2)
(x=3)
(out='ruleset (nil) matched 0, ruleNo=0, action=NONE, priority=HIGHEST')
(out='Ruleset loaded from file "t01.ruleset"')
(out='[ERROR] bad.ruleset:28, bad flags value 'BAD'')
(out='ruleset 0x00000000 matched 0, ruleNo=0, action=NONE, priority=HIGHEST')
(out='comdb2_dump_ruleset: ruleset 0x00000000, generation 6, rule count 6, rule fingerprint count 4')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #1 <null> seqNo 0, action {REJECT} (0x1), adjustment 0, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {a9c8b6ddb5b9e55ee41b7f5a46ec4e45}, evalCount 3, matchCount 0')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #2 <null> seqNo 0, action {LOW_PRIO} (0x8), adjustment 1000, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {f309b21fc81151d21268e9399b36994a}, evalCount 3, matchCount 0')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #3 <null> seqNo 0, action {HIGH_PRIO} (0x10), adjustment 1000, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {fb34995274c6a68a94ae4b9fcfd2d535}, evalCount 3, matchCount 0')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #4 <null> seqNo 0, action {NONE} (0x0), adjustment 0, flags {NONE} (0x0), mode {EXACT} (0x1), originHost {<null>}, originTask {<null>}, user {<null>}, sql {<null>}, fingerprint {4f16a8ec9db90f803e406659938b2602}, evalCount 3, matchCount 0')
(out='comdb2_dump_ruleset_item: ruleset 0x00000000 rule #6 <null> seqNo 0, action {REJECT_ALL} (0x2), adjustment 0, flags {PRINT STOP} (0x6), mode {GLOB NOCASE} (0xA), originHost {<null>}, originTask {<null>}, user {<null>}, sql {CREATE *}, fingerprint {<null>}, evalCount 3, matchCount 0')
