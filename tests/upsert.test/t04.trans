1 SELECT '1a' AS TEST
1 DROP TABLE IF EXISTS t
1 CREATE TABLE t(a int, b int)
1 CREATE UNIQUE INDEX ab ON t(a, b)
1 CREATE UNIQUE INDEX a ON t(a)
1 BEGIN
1 INSERT INTO t(a, b) VALUES(1, 1) ON CONFLICT(a) DO UPDATE SET b = 10
2 INSERT INTO t(a, b) VALUES(1, 2)
2 SELECT a, b FROM t
1 COMMIT
1 SELECT a, b FROM t

1 SELECT '1b' AS TEST
1 DROP TABLE IF EXISTS t
1 CREATE TABLE t(a int, b int)
1 CREATE UNIQUE INDEX a ON t(a)
1 CREATE UNIQUE INDEX ab ON t(a, b)
1 BEGIN
1 INSERT INTO t(a, b) VALUES(1, 1) ON CONFLICT(a) DO UPDATE SET b = 10
2 INSERT INTO t(a, b) VALUES(1, 2)
2 SELECT a, b FROM t
1 COMMIT
1 SELECT a, b FROM t

1 SELECT '2a' AS TEST
1 DROP TABLE IF EXISTS t
1 CREATE TABLE t(a int, b int)
1 CREATE UNIQUE INDEX ab ON t(a, b)
1 CREATE UNIQUE INDEX a ON t(a)
1 BEGIN
1 INSERT INTO t(a, b) VALUES(1, 1) ON CONFLICT(a) DO UPDATE SET b = 2
2 INSERT INTO t(a, b) VALUES(1, 1)
2 SELECT a, b FROM t
1 COMMIT
1 SELECT a, b FROM t

1 SELECT '2b' AS TEST
1 DROP TABLE IF EXISTS t
1 CREATE TABLE t(a int, b int)
1 CREATE UNIQUE INDEX a ON t(a)
1 CREATE UNIQUE INDEX ab ON t(a, b)
1 BEGIN
1 INSERT INTO t(a, b) VALUES(1, 1) ON CONFLICT(a) DO UPDATE SET b = 2
2 INSERT INTO t(a, b) VALUES(1, 1)
2 SELECT a, b FROM t
1 COMMIT
1 SELECT a, b FROM t
