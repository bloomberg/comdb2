# Test that default user can access comdb2_cluster for cluster discovery
# This is required for where_comdb2 functionality

# =============== default user (unauthenticated) ===============

select " can access comdb2_cluster for cluster discovery " as " default user "

# This should succeed - default user can read comdb2_cluster
select 1 from comdb2_cluster limit 1

# These should still fail - default user cannot access other protected system tables
select " cannot access other protected system tables " as " default user "

select 1 from comdb2_appsock_handlers limit 1
select 1 from comdb2_clientstats limit 1
select 1 from comdb2_locks limit 1
select 1 from comdb2_metrics limit 1
select 1 from comdb2_transaction_logs limit 1
select 1 from comdb2_tunables limit 1

# These should succeed - default user can access unrestricted system tables
select " can access unrestricted system tables " as " default user "

select 1 from comdb2_keywords limit 1
select 1 from comdb2_limits limit 1
